<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>颜色选择器 - 在线工具箱</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    <style>
        body {
            background-color: #f8f9fa;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        .navbar {
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .color-display {
            height: 200px;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
        }
        .color-input-group {
            margin-bottom: 15px;
        }
        .color-format-tabs .nav-link {
            color: #6c757d;
        }
        .color-format-tabs .nav-link.active {
            color: #0d6efd;
            font-weight: 500;
        }
        .color-palette {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(40px, 1fr));
            gap: 10px;
            margin-top: 20px;
        }
        .color-palette-item {
            height: 40px;
            border-radius: 5px;
            cursor: pointer;
            transition: transform 0.2s;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .color-palette-item:hover {
            transform: scale(1.1);
        }
        .color-history {
            margin-top: 20px;
        }
        .color-history-item {
            display: inline-block;
            width: 30px;
            height: 30px;
            border-radius: 5px;
            margin-right: 5px;
            margin-bottom: 5px;
            cursor: pointer;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .slider-container {
            margin-bottom: 15px;
        }
        .slider-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
        }
        .color-slider {
            width: 100%;
            height: 10px;
            border-radius: 5px;
            outline: none;
            cursor: pointer;
        }
        .copy-notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 10px 20px;
            background-color: #28a745;
            color: white;
            border-radius: 5px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.3s;
        }
        .copy-notification.show {
            opacity: 1;
        }
    </style>
</head>
<body>
    <!-- 导航栏 -->
    <nav class="navbar navbar-expand-lg navbar-light bg-white sticky-top">
        <div class="container">
            <a class="navbar-brand fw-bold" href="/">
                <i class="bi bi-tools"></i> 工具箱
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="/">首页</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" href="#">颜色选择器</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- 主要内容 -->
    <div class="container mt-4 mb-5">
        <div class="row">
            <div class="col-lg-8 mx-auto">
                <div class="card">
                    <div class="card-header bg-primary text-white">
                        <h4 class="mb-0"><i class="bi bi-palette"></i> 颜色选择器</h4>
                    </div>
                    <div class="card-body">
                        <!-- 颜色显示区域 -->
                        <div class="color-display" id="colorDisplay"></div>
                        
                        <!-- 颜色选择器 -->
                        <div class="mb-4">
                            <label for="colorPicker" class="form-label">选择颜色</label>
                            <div class="d-flex align-items-center">
                                <input type="color" class="form-control form-control-color me-3" id="colorPicker" value="#3366ff" title="选择颜色">
                                <button class="btn btn-outline-secondary" id="randomColor">
                                    <i class="bi bi-shuffle"></i> 随机颜色
                                </button>
                            </div>
                        </div>
                        
                        <!-- RGB滑块 -->
                        <div class="mb-4">
                            <h5>RGB 调节</h5>
                            <div class="slider-container">
                                <div class="slider-label">
                                    <span>红色 (R)</span>
                                    <span id="redValue">51</span>
                                </div>
                                <input type="range" class="form-range color-slider" id="redSlider" min="0" max="255" value="51" style="background: linear-gradient(to right, #000, #ff0000);">
                            </div>
                            <div class="slider-container">
                                <div class="slider-label">
                                    <span>绿色 (G)</span>
                                    <span id="greenValue">102</span>
                                </div>
                                <input type="range" class="form-range color-slider" id="greenSlider" min="0" max="255" value="102" style="background: linear-gradient(to right, #000, #00ff00);">
                            </div>
                            <div class="slider-container">
                                <div class="slider-label">
                                    <span>蓝色 (B)</span>
                                    <span id="blueValue">255</span>
                                </div>
                                <input type="range" class="form-range color-slider" id="blueSlider" min="0" max="255" value="255" style="background: linear-gradient(to right, #000, #0000ff);">
                            </div>
                        </div>
                        
                        <!-- HSL滑块 -->
                        <div class="mb-4">
                            <h5>HSL 调节</h5>
                            <div class="slider-container">
                                <div class="slider-label">
                                    <span>色相 (H)</span>
                                    <span id="hueValue">220°</span>
                                </div>
                                <input type="range" class="form-range color-slider" id="hueSlider" min="0" max="360" value="220" style="background: linear-gradient(to right, #ff0000, #ffff00, #00ff00, #00ffff, #0000ff, #ff00ff, #ff0000);">
                            </div>
                            <div class="slider-container">
                                <div class="slider-label">
                                    <span>饱和度 (S)</span>
                                    <span id="saturationValue">100%</span>
                                </div>
                                <input type="range" class="form-range color-slider" id="saturationSlider" min="0" max="100" value="100" style="background: linear-gradient(to right, #808080, #3366ff);">
                            </div>
                            <div class="slider-container">
                                <div class="slider-label">
                                    <span>亮度 (L)</span>
                                    <span id="lightnessValue">60%</span>
                                </div>
                                <input type="range" class="form-range color-slider" id="lightnessSlider" min="0" max="100" value="60" style="background: linear-gradient(to right, #000, #3366ff, #fff);">
                            </div>
                        </div>
                        
                        <!-- 颜色格式 -->
                        <div class="mb-4">
                            <h5>颜色格式</h5>
                            <ul class="nav nav-tabs color-format-tabs" id="colorFormatTabs" role="tablist">
                                <li class="nav-item" role="presentation">
                                    <button class="nav-link active" id="hex-tab" data-bs-toggle="tab" data-bs-target="#hex" type="button" role="tab">HEX</button>
                                </li>
                                <li class="nav-item" role="presentation">
                                    <button class="nav-link" id="rgb-tab" data-bs-toggle="tab" data-bs-target="#rgb" type="button" role="tab">RGB</button>
                                </li>
                                <li class="nav-item" role="presentation">
                                    <button class="nav-link" id="hsl-tab" data-bs-toggle="tab" data-bs-target="#hsl" type="button" role="tab">HSL</button>
                                </li>
                                <li class="nav-item" role="presentation">
                                    <button class="nav-link" id="cmyk-tab" data-bs-toggle="tab" data-bs-target="#cmyk" type="button" role="tab">CMYK</button>
                                </li>
                            </ul>
                            <div class="tab-content mt-3" id="colorFormatTabsContent">
                                <div class="tab-pane fade show active" id="hex" role="tabpanel">
                                    <div class="input-group">
                                        <input type="text" class="form-control" id="hexValue" value="#3366ff">
                                        <button class="btn btn-outline-secondary" type="button" id="copyHex">
                                            <i class="bi bi-clipboard"></i> 复制
                                        </button>
                                    </div>
                                </div>
                                <div class="tab-pane fade" id="rgb" role="tabpanel">
                                    <div class="input-group">
                                        <input type="text" class="form-control" id="rgbValue" value="rgb(51, 102, 255)">
                                        <button class="btn btn-outline-secondary" type="button" id="copyRgb">
                                            <i class="bi bi-clipboard"></i> 复制
                                        </button>
                                    </div>
                                </div>
                                <div class="tab-pane fade" id="hsl" role="tabpanel">
                                    <div class="input-group">
                                        <input type="text" class="form-control" id="hslValue" value="hsl(220, 100%, 60%)">
                                        <button class="btn btn-outline-secondary" type="button" id="copyHsl">
                                            <i class="bi bi-clipboard"></i> 复制
                                        </button>
                                    </div>
                                </div>
                                <div class="tab-pane fade" id="cmyk" role="tabpanel">
                                    <div class="input-group">
                                        <input type="text" class="form-control" id="cmykValue" value="cmyk(80%, 60%, 0%, 0%)">
                                        <button class="btn btn-outline-secondary" type="button" id="copyCmyk">
                                            <i class="bi bi-clipboard"></i> 复制
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- 预设颜色 -->
                        <div class="mb-4">
                            <h5>预设颜色</h5>
                            <div class="color-palette" id="colorPalette">
                                <!-- 预设颜色将通过JavaScript动态生成 -->
                            </div>
                        </div>
                        
                        <!-- 颜色历史 -->
                        <div>
                            <h5>颜色历史</h5>
                            <div class="color-history" id="colorHistory">
                                <!-- 颜色历史将通过JavaScript动态生成 -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 复制通知 -->
    <div class="copy-notification" id="copyNotification">
        已复制到剪贴板！
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // 初始化变量
            const colorPicker = document.getElementById('colorPicker');
            const colorDisplay = document.getElementById('colorDisplay');
            const randomColorBtn = document.getElementById('randomColor');
            
            // RGB滑块
            const redSlider = document.getElementById('redSlider');
            const greenSlider = document.getElementById('greenSlider');
            const blueSlider = document.getElementById('blueSlider');
            const redValue = document.getElementById('redValue');
            const greenValue = document.getElementById('greenValue');
            const blueValue = document.getElementById('blueValue');
            
            // HSL滑块
            const hueSlider = document.getElementById('hueSlider');
            const saturationSlider = document.getElementById('saturationSlider');
            const lightnessSlider = document.getElementById('lightnessSlider');
            const hueValue = document.getElementById('hueValue');
            const saturationValue = document.getElementById('saturationValue');
            const lightnessValue = document.getElementById('lightnessValue');
            
            // 颜色格式输入框
            const hexValue = document.getElementById('hexValue');
            const rgbValue = document.getElementById('rgbValue');
            const hslValue = document.getElementById('hslValue');
            const cmykValue = document.getElementById('cmykValue');
            
            // 复制按钮
            const copyHex = document.getElementById('copyHex');
            const copyRgb = document.getElementById('copyRgb');
            const copyHsl = document.getElementById('copyHsl');
            const copyCmyk = document.getElementById('copyCmyk');
            
            // 预设颜色和历史
            const colorPalette = document.getElementById('colorPalette');
            const colorHistory = document.getElementById('colorHistory');
            
            // 复制通知
            const copyNotification = document.getElementById('copyNotification');
            
            // 预设颜色数组
            const presetColors = [
                '#FF5733', '#33FF57', '#3357FF', '#F333FF', '#FF33A1', 
                '#33FFF6', '#FF8C33', '#8C33FF', '#33FF8C', '#FF3333',
                '#000000', '#FFFFFF', '#FF0000', '#00FF00', '#0000FF',
                '#FFFF00', '#FF00FF', '#00FFFF', '#FFA500', '#800080'
            ];
            
            // 颜色历史数组
            let colorHistoryArray = JSON.parse(localStorage.getItem('colorHistory')) || [];
            
            // 初始化
            updateColor(colorPicker.value);
            generateColorPalette();
            updateColorHistory();
            
            // 颜色选择器变化事件
            colorPicker.addEventListener('input', function() {
                updateColor(this.value);
            });
            
            // 随机颜色按钮
            randomColorBtn.addEventListener('click', function() {
                const randomColor = '#' + Math.floor(Math.random()*16777215).toString(16).padStart(6, '0');
                colorPicker.value = randomColor;
                updateColor(randomColor);
            });
            
            // RGB滑块变化事件
            redSlider.addEventListener('input', function() {
                redValue.textContent = this.value;
                updateColorFromRgb();
            });
            
            greenSlider.addEventListener('input', function() {
                greenValue.textContent = this.value;
                updateColorFromRgb();
            });
            
            blueSlider.addEventListener('input', function() {
                blueValue.textContent = this.value;
                updateColorFromRgb();
            });
            
            // HSL滑块变化事件
            hueSlider.addEventListener('input', function() {
                hueValue.textContent = this.value + '°';
                updateColorFromHsl();
            });
            
            saturationSlider.addEventListener('input', function() {
                saturationValue.textContent = this.value + '%';
                updateColorFromHsl();
            });
            
            lightnessSlider.addEventListener('input', function() {
                lightnessValue.textContent = this.value + '%';
                updateColorFromHsl();
            });
            
            // 颜色格式输入框变化事件
            hexValue.addEventListener('input', function() {
                if (/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/.test(this.value)) {
                    colorPicker.value = this.value;
                    updateColor(this.value);
                }
            });
            
            rgbValue.addEventListener('input', function() {
                const match = this.value.match(/rgb\((\d+),\s*(\d+),\s*(\d+)\)/);
                if (match) {
                    const r = parseInt(match[1]);
                    const g = parseInt(match[2]);
                    const b = parseInt(match[3]);
                    if (r >= 0 && r <= 255 && g >= 0 && g <= 255 && b >= 0 && b <= 255) {
                        updateColorFromRgbInput(r, g, b);
                    }
                }
            });
            
            hslValue.addEventListener('input', function() {
                const match = this.value.match(/hsl\((\d+),\s*(\d+)%,\s*(\d+)%\)/);
                if (match) {
                    const h = parseInt(match[1]);
                    const s = parseInt(match[2]);
                    const l = parseInt(match[3]);
                    if (h >= 0 && h <= 360 && s >= 0 && s <= 100 && l >= 0 && l <= 100) {
                        updateColorFromHslInput(h, s, l);
                    }
                }
            });
            
            // 复制按钮事件
            copyHex.addEventListener('click', function() {
                copyToClipboard(hexValue.value);
            });
            
            copyRgb.addEventListener('click', function() {
                copyToClipboard(rgbValue.value);
            });
            
            copyHsl.addEventListener('click', function() {
                copyToClipboard(hslValue.value);
            });
            
            copyCmyk.addEventListener('click', function() {
                copyToClipboard(cmykValue.value);
            });
            
            // 更新颜色函数
            function updateColor(hex) {
                // 更新颜色显示区域
                colorDisplay.style.backgroundColor = hex;
                
                // 更新RGB值
                const rgb = hexToRgb(hex);
                redSlider.value = rgb.r;
                greenSlider.value = rgb.g;
                blueSlider.value = rgb.b;
                redValue.textContent = rgb.r;
                greenValue.textContent = rgb.g;
                blueValue.textContent = rgb.b;
                
                // 更新HSL值
                const hsl = rgbToHsl(rgb.r, rgb.g, rgb.b);
                hueSlider.value = hsl.h;
                saturationSlider.value = hsl.s;
                lightnessSlider.value = hsl.l;
                hueValue.textContent = hsl.h + '°';
                saturationValue.textContent = hsl.s + '%';
                lightnessValue.textContent = hsl.l + '%';
                
                // 更新颜色格式输入框
                hexValue.value = hex;
                rgbValue.value = `rgb(${rgb.r}, ${rgb.g}, ${rgb.b})`;
                hslValue.value = `hsl(${hsl.h}, ${hsl.s}%, ${hsl.l}%)`;
                
                // 更新CMYK值
                const cmyk = rgbToCmyk(rgb.r, rgb.g, rgb.b);
                cmykValue.value = `cmyk(${cmyk.c}%, ${cmyk.m}%, ${cmyk.y}%, ${cmyk.k}%)`;
                
                // 更新HSL滑块背景
                updateHslSliderBackgrounds(hsl.h, hsl.s, hsl.l);
                
                // 添加到颜色历史
                addToColorHistory(hex);
            }
            
            // 从RGB滑块更新颜色
            function updateColorFromRgb() {
                const r = parseInt(redSlider.value);
                const g = parseInt(greenSlider.value);
                const b = parseInt(blueSlider.value);
                const hex = rgbToHex(r, g, b);
                
                colorPicker.value = hex;
                updateColor(hex);
            }
            
            // 从HSL滑块更新颜色
            function updateColorFromHsl() {
                const h = parseInt(hueSlider.value);
                const s = parseInt(saturationSlider.value);
                const l = parseInt(lightnessSlider.value);
                const rgb = hslToRgb(h, s, l);
                const hex = rgbToHex(rgb.r, rgb.g, rgb.b);
                
                colorPicker.value = hex;
                updateColor(hex);
            }
            
            // 从RGB输入框更新颜色
            function updateColorFromRgbInput(r, g, b) {
                const hex = rgbToHex(r, g, b);
                colorPicker.value = hex;
                updateColor(hex);
            }
            
            // 从HSL输入框更新颜色
            function updateColorFromHslInput(h, s, l) {
                const rgb = hslToRgb(h, s, l);
                const hex = rgbToHex(rgb.r, rgb.g, rgb.b);
                colorPicker.value = hex;
                updateColor(hex);
            }
            
            // 更新HSL滑块背景
            function updateHslSliderBackgrounds(h, s, l) {
                // 更新饱和度滑块背景
                saturationSlider.style.background = `linear-gradient(to right, hsl(${h}, 0%, ${l}%), hsl(${h}, 100%, ${l}%))`;
                
                // 更新亮度滑块背景
                lightnessSlider.style.background = `linear-gradient(to right, hsl(${h}, ${s}%, 0%), hsl(${h}, ${s}%, 50%), hsl(${h}, ${s}%, 100%))`;
            }
            
            // 生成预设颜色
            function generateColorPalette() {
                colorPalette.innerHTML = '';
                presetColors.forEach(color => {
                    const colorItem = document.createElement('div');
                    colorItem.className = 'color-palette-item';
                    colorItem.style.backgroundColor = color;
                    colorItem.title = color;
                    colorItem.addEventListener('click', function() {
                        colorPicker.value = color;
                        updateColor(color);
                    });
                    colorPalette.appendChild(colorItem);
                });
            }
            
            // 添加到颜色历史
            function addToColorHistory(color) {
                // 避免重复添加相同颜色
                if (colorHistoryArray.includes(color)) {
                    return;
                }
                
                // 添加到数组开头
                colorHistoryArray.unshift(color);
                
                // 限制历史记录数量
                if (colorHistoryArray.length > 20) {
                    colorHistoryArray.pop();
                }
                
                // 保存到本地存储
                localStorage.setItem('colorHistory', JSON.stringify(colorHistoryArray));
                
                // 更新显示
                updateColorHistory();
            }
            
            // 更新颜色历史显示
            function updateColorHistory() {
                colorHistory.innerHTML = '';
                colorHistoryArray.forEach(color => {
                    const historyItem = document.createElement('div');
                    historyItem.className = 'color-history-item';
                    historyItem.style.backgroundColor = color;
                    historyItem.title = color;
                    historyItem.addEventListener('click', function() {
                        colorPicker.value = color;
                        updateColor(color);
                    });
                    colorHistory.appendChild(historyItem);
                });
            }
            
            // 复制到剪贴板
            function copyToClipboard(text) {
                navigator.clipboard.writeText(text).then(function() {
                    // 显示复制通知
                    copyNotification.classList.add('show');
                    
                    // 3秒后隐藏通知
                    setTimeout(function() {
                        copyNotification.classList.remove('show');
                    }, 3000);
                }).catch(function(err) {
                    console.error('无法复制文本: ', err);
                });
            }
            
            // 颜色转换函数
            function hexToRgb(hex) {
                const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
                return result ? {
                    r: parseInt(result[1], 16),
                    g: parseInt(result[2], 16),
                    b: parseInt(result[3], 16)
                } : null;
            }
            
            function rgbToHex(r, g, b) {
                return "#" + ((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1);
            }
            
            function rgbToHsl(r, g, b) {
                r /= 255;
                g /= 255;
                b /= 255;
                
                const max = Math.max(r, g, b);
                const min = Math.min(r, g, b);
                let h, s, l = (max + min) / 2;
                
                if (max === min) {
                    h = s = 0; // 灰度
                } else {
                    const d = max - min;
                    s = l > 0.5 ? d / (2 - max - min) : d / (max + min);
                    
                    switch (max) {
                        case r: h = ((g - b) / d + (g < b ? 6 : 0)) / 6; break;
                        case g: h = ((b - r) / d + 2) / 6; break;
                        case b: h = ((r - g) / d + 4) / 6; break;
                    }
                }
                
                return {
                    h: Math.round(h * 360),
                    s: Math.round(s * 100),
                    l: Math.round(l * 100)
                };
            }
            
            function hslToRgb(h, s, l) {
                h /= 360;
                s /= 100;
                l /= 100;
                
                let r, g, b;
                
                if (s === 0) {
                    r = g = b = l; // 灰度
                } else {
                    const hue2rgb = function(p, q, t) {
                        if (t < 0) t += 1;
                        if (t > 1) t -= 1;
                        if (t < 1/6) return p + (q - p) * 6 * t;
                        if (t < 1/2) return q;
                        if (t < 2/3) return p + (q - p) * (2/3 - t) * 6;
                        return p;
                    };
                    
                    const q = l < 0.5 ? l * (1 + s) : l + s - l * s;
                    const p = 2 * l - q;
                    
                    r = hue2rgb(p, q, h + 1/3);
                    g = hue2rgb(p, q, h);
                    b = hue2rgb(p, q, h - 1/3);
                }
                
                return {
                    r: Math.round(r * 255),
                    g: Math.round(g * 255),
                    b: Math.round(b * 255)
                };
            }
            
            function rgbToCmyk(r, g, b) {
                r /= 255;
                g /= 255;
                b /= 255;
                
                const k = 1 - Math.max(r, g, b);
                const c = (1 - r - k) / (1 - k) || 0;
                const m = (1 - g - k) / (1 - k) || 0;
                const y = (1 - b - k) / (1 - k) || 0;
                
                return {
                    c: Math.round(c * 100),
                    m: Math.round(m * 100),
                    y: Math.round(y * 100),
                    k: Math.round(k * 100)
                };
            }
        });
    </script>
</body>
</html>