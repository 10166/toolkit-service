<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UUID生成器 - 在线工具箱</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    <style>
        body {
            background-color: #f8f9fa;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
            text-align: center;
        }
        .tool-section {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            margin-bottom: 25px;
        }
        .section-title {
            font-size: 1.3rem;
            color: #333;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .section-title::before {
            content: '';
            width: 4px;
            height: 20px;
            background: #667eea;
            border-radius: 2px;
        }
        .controls {
            display: flex;
            gap: 15px;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }
        .btn-secondary {
            background: #f5f5f5;
            color: #333;
        }
        .btn-secondary:hover {
            background: #e8e8e8;
        }
        .options {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        .option-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        .option-label {
            font-weight: 500;
            color: #555;
            font-size: 14px;
        }
        .option-input {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
        }
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            display: flex;
            align-items: center;
            gap: 10px;
            transform: translateX(400px);
            transition: transform 0.3s;
            z-index: 1000;
        }
        .notification.show {
            transform: translateX(0);
        }
        .notification.success {
            border-left: 4px solid #4caf50;
        }
        .notification.error {
            border-left: 4px solid #f44336;
        }
        .error-message {
            color: #f44336;
            margin-top: 10px;
            padding: 10px;
            background: #ffebee;
            border-radius: 6px;
            display: none;
        }
        .uuid-result {
            background: #f9f9f9;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            border-left: 4px solid #667eea;
        }
        .uuid-result-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        .uuid-result-title {
            font-weight: 600;
            color: #333;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .uuid-result-value {
            font-family: Consolas, Monaco, "Courier New", monospace;
            font-size: 16px;
            word-break: break-all;
            background: white;
            padding: 10px;
            border-radius: 6px;
            border: 1px solid #eee;
        }
        .copy-btn {
            padding: 5px 10px;
            font-size: 14px;
            border-radius: 6px;
        }
        .uuid-list {
            margin-top: 20px;
        }
        .uuid-item {
            background: #f9f9f9;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 10px;
            border-left: 4px solid #667eea;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .uuid-value {
            font-family: Consolas, Monaco, "Courier New", monospace;
            font-size: 14px;
            word-break: break-all;
            flex-grow: 1;
            margin-right: 15px;
        }
        .uuid-actions {
            display: flex;
            gap: 10px;
        }
        .stats {
            display: flex;
            gap: 15px;
            margin-top: 15px;
            font-size: 14px;
            color: #666;
        }
        .stat-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        .reference-section {
            margin-top: 30px;
        }
        .reference-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
            font-size: 14px;
        }
        .reference-table th, .reference-table td {
            padding: 8px 12px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }
        .reference-table th {
            background-color: #f5f5f5;
            font-weight: 600;
        }
        .reference-table tr:hover {
            background-color: #f9f9f9;
        }
        .bulk-section {
            margin-top: 20px;
        }
        .bulk-controls {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
            flex-wrap: wrap;
            align-items: flex-end;
        }
        .bulk-input-group {
            flex-grow: 1;
        }
        .bulk-input {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
        }
        .format-options {
            display: flex;
            gap: 10px;
            margin-top: 10px;
            flex-wrap: wrap;
        }
        .format-option {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        .format-option input[type="checkbox"] {
            margin: 0;
        }
        .format-option label {
            margin: 0;
            font-size: 14px;
            cursor: pointer;
        }
        .uuid-preview {
            background: #f5f7fa;
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            font-family: Consolas, Monaco, "Courier New", monospace;
            font-size: 14px;
            line-height: 1.6;
            white-space: pre-wrap;
            word-break: break-all;
            max-height: 300px;
            overflow-y: auto;
        }
        @media (max-width: 768px) {
            .controls {
                flex-direction: column;
            }
            .btn {
                width: 100%;
                justify-content: center;
            }
            .uuid-item {
                flex-direction: column;
                align-items: flex-start;
            }
            .uuid-actions {
                width: 100%;
                justify-content: flex-end;
                margin-top: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1><i class="bi bi-key"></i> UUID生成器</h1>
            <p>生成各种版本的UUID，支持批量生成和格式化输出</p>
        </div>

        <div class="tool-section">
            <h2 class="section-title">UUID生成选项</h2>
            <div class="options">
                <div class="option-group">
                    <label class="option-label">UUID版本</label>
                    <select id="uuidVersion" class="option-input">
                        <option value="v4" selected>UUID v4 (随机)</option>
                        <option value="v1">UUID v1 (基于时间)</option>
                        <option value="v3">UUID v3 (基于MD5)</option>
                        <option value="v5">UUID v5 (基于SHA-1)</option>
                        <option value="nil">Nil UUID (全零)</option>
                    </select>
                </div>
                <div class="option-group" id="namespaceGroup" style="display: none;">
                    <label class="option-label">命名空间</label>
                    <select id="namespace" class="option-input">
                        <option value="dns">DNS (6ba7b810-9dad-11d1-80b4-00c04fd430c8)</option>
                        <option value="url">URL (6ba7b811-9dad-11d1-80b4-00c04fd430c8)</option>
                        <option value="oid">OID (6ba7b812-9dad-11d1-80b4-00c04fd430c8)</option>
                        <option value="x500">X.500 (6ba7b814-9dad-11d1-80b4-00c04fd430c8)</option>
                    </select>
                </div>
                <div class="option-group" id="nameGroup" style="display: none;">
                    <label class="option-label">名称</label>
                    <input type="text" id="name" class="option-input" placeholder="输入名称...">
                </div>
                <div class="option-group">
                    <label class="option-label">输出格式</label>
                    <select id="outputFormat" class="option-input">
                        <option value="standard" selected>标准格式 (xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx)</option>
                        <option value="hex">十六进制 (xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx)</option>
                        <option value="urn">URN格式 (urn:uuid:xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx)</option>
                        <option value="base64">Base64格式</option>
                    </select>
                </div>
                <div class="option-group">
                    <label class="option-label">大小写</label>
                    <select id="caseFormat" class="option-input">
                        <option value="lower" selected>小写</option>
                        <option value="upper">大写</option>
                    </select>
                </div>
            </div>
            
            <div class="error-message" id="errorMessage">
                <i class="bi bi-exclamation-triangle"></i> <span id="errorText"></span>
            </div>
            
            <div class="controls">
                <button id="generateBtn" class="btn btn-primary"><i class="bi bi-lightning"></i> 生成UUID</button>
                <button id="copyBtn" class="btn btn-secondary"><i class="bi bi-clipboard"></i> 复制</button>
                <button id="clearBtn" class="btn btn-secondary"><i class="bi bi-trash"></i> 清空</button>
            </div>
            
            <div class="uuid-result" id="uuidResult" style="display: none;">
                <div class="uuid-result-header">
                    <div class="uuid-result-title">
                        <i class="bi bi-key"></i> 生成的UUID
                    </div>
                    <button id="copyResultBtn" class="btn btn-secondary copy-btn"><i class="bi bi-clipboard"></i> 复制</button>
                </div>
                <div class="uuid-result-value" id="uuidValue"></div>
            </div>
        </div>

        <div class="tool-section bulk-section">
            <h2 class="section-title">批量生成</h2>
            <div class="bulk-controls">
                <div class="option-group">
                    <label class="option-label">生成数量</label>
                    <input type="number" id="bulkCount" class="option-input" min="1" max="1000" value="10">
                </div>
                <div class="option-group">
                    <label class="option-label">分隔符</label>
                    <select id="separator" class="option-input">
                        <option value="newline" selected>换行</option>
                        <option value="comma">逗号</option>
                        <option value="semicolon">分号</option>
                        <option value="space">空格</option>
                        <option value="none">无分隔符</option>
                    </select>
                </div>
                <button id="bulkGenerateBtn" class="btn btn-primary"><i class="bi bi-list-ul"></i> 批量生成</button>
                <button id="copyBulkBtn" class="btn btn-secondary"><i class="bi bi-clipboard"></i> 复制全部</button>
            </div>
            
            <div class="format-options">
                <div class="format-option">
                    <input type="checkbox" id="includePrefix" checked>
                    <label for="includePrefix">包含序号前缀</label>
                </div>
                <div class="format-option">
                    <input type="checkbox" id="includeQuotes">
                    <label for="includeQuotes">添加引号</label>
                </div>
                <div class="format-option">
                    <input type="checkbox" id="includeBrackets">
                    <label for="includeBrackets">添加方括号</label>
                </div>
            </div>
            
            <div class="uuid-preview" id="bulkPreview">点击"批量生成"按钮查看结果</div>
        </div>

        <div class="tool-section">
            <h2 class="section-title">历史记录</h2>
            <div id="uuidHistory" class="uuid-list">
                <p class="text-muted">暂无历史记录</p>
            </div>
            
            <div class="controls">
                <button id="clearHistoryBtn" class="btn btn-secondary"><i class="bi bi-trash"></i> 清空历史</button>
                <button id="copyHistoryBtn" class="btn btn-secondary"><i class="bi bi-clipboard"></i> 复制全部</button>
            </div>
            
            <div class="stats">
                <div class="stat-item">
                    <i class="bi bi-hash"></i> <span id="historyCount">0</span> 个历史记录
                </div>
                <div class="stat-item">
                    <i class="bi bi-clock"></i> <span id="lastGenerated">-</span>
                </div>
            </div>
        </div>

        <div class="tool-section reference-section">
            <h2 class="section-title">UUID版本参考</h2>
            <table class="reference-table">
                <thead>
                    <tr>
                        <th>版本</th>
                        <th>名称</th>
                        <th>生成方式</th>
                        <th>特点</th>
                        <th>应用场景</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>UUID v1</code></td>
                        <td>基于时间</td>
                        <td>时间戳 + MAC地址</td>
                        <td>包含时间信息，有序性</td>
                        <td>需要时间顺序的场景</td>
                    </tr>
                    <tr>
                        <td><code>UUID v3</code></td>
                        <td>基于MD5</td>
                        <td>命名空间 + 名称 + MD5</td>
                        <td>确定性生成，相同输入产生相同输出</td>
                        <td>需要从名称生成唯一ID的场景</td>
                    </tr>
                    <tr>
                        <td><code>UUID v4</code></td>
                        <td>随机</td>
                        <td>随机数或伪随机数</td>
                        <td>完全随机，无序</td>
                        <td>通用唯一标识符，最常用</td>
                    </tr>
                    <tr>
                        <td><code>UUID v5</code></td>
                        <td>基于SHA-1</td>
                        <td>命名空间 + 名称 + SHA-1</td>
                        <td>确定性生成，比v3更安全</td>
                        <td>需要从名称生成唯一ID且更安全的场景</td>
                    </tr>
                    <tr>
                        <td><code>Nil UUID</code></td>
                        <td>全零UUID</td>
                        <td>所有位都为零</td>
                        <td>特殊UUID，表示空值</td>
                        <td>表示空或未设置的UUID</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <div id="notification" class="notification">
        <span id="notificationText"></span>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/uuid@9.0.0/dist/umd/uuidv4.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/uuid@9.0.0/dist/umd/uuidv1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/uuid@9.0.0/dist/umd/uuidv3.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/uuid@9.0.0/dist/umd/uuidv5.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const uuidVersion = document.getElementById('uuidVersion');
            const namespace = document.getElementById('namespace');
            const name = document.getElementById('name');
            const namespaceGroup = document.getElementById('namespaceGroup');
            const nameGroup = document.getElementById('nameGroup');
            const outputFormat = document.getElementById('outputFormat');
            const caseFormat = document.getElementById('caseFormat');
            const generateBtn = document.getElementById('generateBtn');
            const copyBtn = document.getElementById('copyBtn');
            const clearBtn = document.getElementById('clearBtn');
            const errorMessage = document.getElementById('errorMessage');
            const errorText = document.getElementById('errorText');
            const notification = document.getElementById('notification');
            const notificationText = document.getElementById('notificationText');
            const uuidResult = document.getElementById('uuidResult');
            const uuidValue = document.getElementById('uuidValue');
            const copyResultBtn = document.getElementById('copyResultBtn');
            const bulkCount = document.getElementById('bulkCount');
            const separator = document.getElementById('separator');
            const bulkGenerateBtn = document.getElementById('bulkGenerateBtn');
            const copyBulkBtn = document.getElementById('copyBulkBtn');
            const includePrefix = document.getElementById('includePrefix');
            const includeQuotes = document.getElementById('includeQuotes');
            const includeBrackets = document.getElementById('includeBrackets');
            const bulkPreview = document.getElementById('bulkPreview');
            const uuidHistory = document.getElementById('uuidHistory');
            const clearHistoryBtn = document.getElementById('clearHistoryBtn');
            const copyHistoryBtn = document.getElementById('copyHistoryBtn');
            const historyCount = document.getElementById('historyCount');
            const lastGenerated = document.getElementById('lastGenerated');
            
            let currentUUID = '';
            let history = [];
            
            // 从本地存储加载历史记录
            loadHistory();
            
            // UUID版本变化
            uuidVersion.addEventListener('change', function() {
                if (this.value === 'v3' || this.value === 'v5') {
                    namespaceGroup.style.display = 'block';
                    nameGroup.style.display = 'block';
                } else {
                    namespaceGroup.style.display = 'none';
                    nameGroup.style.display = 'none';
                }
            });
            
            // 生成UUID
            generateBtn.addEventListener('click', function() {
                try {
                    const version = uuidVersion.value;
                    let uuid;
                    
                    switch (version) {
                        case 'v1':
                            uuid = uuidv1();
                            break;
                        case 'v3':
                            const namespaceV3 = getNamespaceUUID(namespace.value);
                            const nameV3 = name.value.trim();
                            if (!nameV3) {
                                showError('请输入名称');
                                return;
                            }
                            uuid = uuidv3(nameV3, namespaceV3);
                            break;
                        case 'v4':
                            uuid = uuidv4();
                            break;
                        case 'v5':
                            const namespaceV5 = getNamespaceUUID(namespace.value);
                            const nameV5 = name.value.trim();
                            if (!nameV5) {
                                showError('请输入名称');
                                return;
                            }
                            uuid = uuidv5(nameV5, namespaceV5);
                            break;
                        case 'nil':
                            uuid = '00000000-0000-0000-0000-000000000000';
                            break;
                    }
                    
                    // 格式化UUID
                    const formattedUUID = formatUUID(uuid);
                    
                    // 显示结果
                    uuidValue.textContent = formattedUUID;
                    uuidResult.style.display = 'block';
                    currentUUID = formattedUUID;
                    
                    // 添加到历史记录
                    addToHistory(formattedUUID, version);
                    
                    showNotification('UUID生成成功', 'success');
                    errorMessage.style.display = 'none';
                } catch (error) {
                    showError('UUID生成失败: ' + error.message);
                }
            });
            
            // 复制按钮
            copyBtn.addEventListener('click', function() {
                if (!currentUUID) {
                    showError('请先生成UUID');
                    return;
                }
                
                navigator.clipboard.writeText(currentUUID).then(() => {
                    showNotification('UUID已复制到剪贴板', 'success');
                }).catch(err => {
                    showError('复制失败: ' + err);
                });
            });
            
            // 复制结果按钮
            copyResultBtn.addEventListener('click', function() {
                navigator.clipboard.writeText(currentUUID).then(() => {
                    showNotification('UUID已复制到剪贴板', 'success');
                }).catch(err => {
                    showError('复制失败: ' + err);
                });
            });
            
            // 清空按钮
            clearBtn.addEventListener('click', function() {
                uuidResult.style.display = 'none';
                currentUUID = '';
                errorMessage.style.display = 'none';
            });
            
            // 批量生成
            bulkGenerateBtn.addEventListener('click', function() {
                try {
                    const count = parseInt(bulkCount.value);
                    if (isNaN(count) || count < 1 || count > 1000) {
                        showError('生成数量必须是1到1000之间的整数');
                        return;
                    }
                    
                    const version = uuidVersion.value;
                    const sep = separator.value;
                    const prefix = includePrefix.checked;
                    const quotes = includeQuotes.checked;
                    const brackets = includeBrackets.checked;
                    
                    let uuids = [];
                    
                    for (let i = 0; i < count; i++) {
                        let uuid;
                        
                        switch (version) {
                            case 'v1':
                                uuid = uuidv1();
                                break;
                            case 'v3':
                                const namespaceV3 = getNamespaceUUID(namespace.value);
                                const nameV3 = name.value.trim() + i; // 添加索引确保唯一性
                                uuid = uuidv3(nameV3, namespaceV3);
                                break;
                            case 'v4':
                                uuid = uuidv4();
                                break;
                            case 'v5':
                                const namespaceV5 = getNamespaceUUID(namespace.value);
                                const nameV5 = name.value.trim() + i; // 添加索引确保唯一性
                                uuid = uuidv5(nameV5, namespaceV5);
                                break;
                            case 'nil':
                                uuid = '00000000-0000-0000-0000-000000000000';
                                break;
                        }
                        
                        // 格式化UUID
                        const formattedUUID = formatUUID(uuid);
                        
                        // 应用格式选项
                        let item = formattedUUID;
                        if (quotes) item = `"${item}"`;
                        if (brackets) item = `[${item}]`;
                        if (prefix) item = `${i + 1}. ${item}`;
                        
                        uuids.push(item);
                    }
                    
                    // 应用分隔符
                    let separatorChar = '\n';
                    switch (sep) {
                        case 'comma':
                            separatorChar = ', ';
                            break;
                        case 'semicolon':
                            separatorChar = '; ';
                            break;
                        case 'space':
                            separatorChar = ' ';
                            break;
                        case 'none':
                            separatorChar = '';
                            break;
                    }
                    
                    const result = uuids.join(separatorChar);
                    bulkPreview.textContent = result;
                    
                    showNotification(`成功生成 ${count} 个UUID`, 'success');
                    errorMessage.style.display = 'none';
                } catch (error) {
                    showError('批量生成失败: ' + error.message);
                }
            });
            
            // 复制批量结果
            copyBulkBtn.addEventListener('click', function() {
                const text = bulkPreview.textContent;
                if (text === '点击"批量生成"按钮查看结果') {
                    showError('请先生成UUID');
                    return;
                }
                
                navigator.clipboard.writeText(text).then(() => {
                    showNotification('批量UUID已复制到剪贴板', 'success');
                }).catch(err => {
                    showError('复制失败: ' + err);
                });
            });
            
            // 清空历史记录
            clearHistoryBtn.addEventListener('click', function() {
                if (confirm('确定要清空所有历史记录吗？')) {
                    history = [];
                    saveHistory();
                    renderHistory();
                    showNotification('历史记录已清空', 'success');
                }
            });
            
            // 复制历史记录
            copyHistoryBtn.addEventListener('click', function() {
                if (history.length === 0) {
                    showError('没有历史记录可复制');
                    return;
                }
                
                const uuids = history.map(item => item.uuid).join('\n');
                navigator.clipboard.writeText(uuids).then(() => {
                    showNotification('历史记录已复制到剪贴板', 'success');
                }).catch(err => {
                    showError('复制失败: ' + err);
                });
            });
            
            // 格式化UUID
            function formatUUID(uuid) {
                const format = outputFormat.value;
                const caseFormatValue = caseFormat.value;
                
                let result = uuid;
                
                // 应用大小写格式
                if (caseFormatValue === 'upper') {
                    result = result.toUpperCase();
                } else {
                    result = result.toLowerCase();
                }
                
                // 应用输出格式
                switch (format) {
                    case 'hex':
                        result = result.replace(/-/g, '');
                        break;
                    case 'urn':
                        result = `urn:uuid:${result}`;
                        break;
                    case 'base64':
                        // 将UUID转换为Base64
                        const hex = result.replace(/-/g, '');
                        const bytes = [];
                        for (let i = 0; i < hex.length; i += 2) {
                            bytes.push(parseInt(hex.substr(i, 2), 16));
                        }
                        const binary = String.fromCharCode.apply(null, bytes);
                        result = btoa(binary);
                        break;
                }
                
                return result;
            }
            
            // 获取命名空间UUID
            function getNamespaceUUID(namespace) {
                switch (namespace) {
                    case 'dns':
                        return '6ba7b810-9dad-11d1-80b4-00c04fd430c8';
                    case 'url':
                        return '6ba7b811-9dad-11d1-80b4-00c04fd430c8';
                    case 'oid':
                        return '6ba7b812-9dad-11d1-80b4-00c04fd430c8';
                    case 'x500':
                        return '6ba7b814-9dad-11d1-80b4-00c04fd430c8';
                    default:
                        return '6ba7b810-9dad-11d1-80b4-00c04fd430c8';
                }
            }
            
            // 添加到历史记录
            function addToHistory(uuid, version) {
                const timestamp = new Date();
                const historyItem = {
                    uuid: uuid,
                    version: version,
                    timestamp: timestamp
                };
                
                // 添加到开头
                history.unshift(historyItem);
                
                // 限制历史记录数量
                if (history.length > 50) {
                    history = history.slice(0, 50);
                }
                
                // 保存到本地存储
                saveHistory();
                
                // 更新显示
                renderHistory();
            }
            
            // 渲染历史记录
            function renderHistory() {
                if (history.length === 0) {
                    uuidHistory.innerHTML = '<p class="text-muted">暂无历史记录</p>';
                    historyCount.textContent = '0';
                    lastGenerated.textContent = '-';
                    return;
                }
                
                let historyHtml = '';
                history.forEach((item, index) => {
                    const versionNames = {
                        'v1': 'UUID v1',
                        'v3': 'UUID v3',
                        'v4': 'UUID v4',
                        'v5': 'UUID v5',
                        'nil': 'Nil UUID'
                    };
                    
                    const timeStr = item.timestamp.toLocaleString();
                    
                    historyHtml += `
                        <div class="uuid-item">
                            <div class="uuid-value">${item.uuid}</div>
                            <div class="uuid-actions">
                                <button class="btn btn-secondary copy-btn" data-uuid="${item.uuid}">
                                    <i class="bi bi-clipboard"></i>
                                </button>
                                <button class="btn btn-secondary delete-btn" data-index="${index}">
                                    <i class="bi bi-trash"></i>
                                </button>
                            </div>
                            <div class="text-muted mt-2">
                                <small>${versionNames[item.version]} | ${timeStr}</small>
                            </div>
                        </div>
                    `;
                });
                
                uuidHistory.innerHTML = historyHtml;
                
                // 更新统计信息
                historyCount.textContent = history.length;
                lastGenerated.textContent = history[0].timestamp.toLocaleString();
                
                // 添加复制按钮事件
                const copyBtns = uuidHistory.querySelectorAll('.copy-btn');
                copyBtns.forEach(btn => {
                    btn.addEventListener('click', function() {
                        const uuid = this.getAttribute('data-uuid');
                        navigator.clipboard.writeText(uuid).then(() => {
                            showNotification('UUID已复制到剪贴板', 'success');
                        }).catch(err => {
                            showError('复制失败: ' + err);
                        });
                    });
                });
                
                // 添加删除按钮事件
                const deleteBtns = uuidHistory.querySelectorAll('.delete-btn');
                deleteBtns.forEach(btn => {
                    btn.addEventListener('click', function() {
                        const index = parseInt(this.getAttribute('data-index'));
                        history.splice(index, 1);
                        saveHistory();
                        renderHistory();
                        showNotification('历史记录已删除', 'success');
                    });
                });
            }
            
            // 保存历史记录到本地存储
            function saveHistory() {
                const historyData = history.map(item => ({
                    uuid: item.uuid,
                    version: item.version,
                    timestamp: item.timestamp.toISOString()
                }));
                localStorage.setItem('uuidHistory', JSON.stringify(historyData));
            }
            
            // 从本地存储加载历史记录
            function loadHistory() {
                const savedHistory = localStorage.getItem('uuidHistory');
                if (savedHistory) {
                    try {
                        const historyData = JSON.parse(savedHistory);
                        history = historyData.map(item => ({
                            uuid: item.uuid,
                            version: item.version,
                            timestamp: new Date(item.timestamp)
                        }));
                        renderHistory();
                    } catch (error) {
                        console.error('加载历史记录失败:', error);
                        history = [];
                    }
                }
            }
            
            // 显示错误信息
            function showError(message) {
                errorText.textContent = message;
                errorMessage.style.display = 'block';
            }
            
            // 显示通知
            function showNotification(message, type) {
                notificationText.textContent = message;
                notification.className = 'notification ' + type;
                notification.classList.add('show');
                
                setTimeout(() => {
                    notification.classList.remove('show');
                }, 3000);
            }
        });
    </script>
</body>
</html>